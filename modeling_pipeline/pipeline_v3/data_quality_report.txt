2026-01-28 02:49:12,492 - INFO - Loading CSV files...
2026-01-28 02:49:12,507 - INFO - âœ… Loaded fixtures: 18,044 rows
2026-01-28 02:49:12,533 - INFO - âœ… Loaded statistics: 1,830 rows
/Users/ankurgupta/code/predictorV2/modeling_pipeline/pipeline_v3/scripts/analyze_data_quality.py:68: DtypeWarning: Columns (6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,46,47,48,50,51,52,53,56,59) have mixed types. Specify dtype option on import or set low_memory=False.
  self.lineups = pd.read_csv(self.data_dir / 'lineups.csv', on_bad_lines='skip')
2026-01-28 02:49:13,849 - INFO - âœ… Loaded lineups: 531,717 rows
2026-01-28 02:49:13,863 - INFO - âœ… Loaded sidelined: 100,601 rows

================================================================================
CSV DATA QUALITY ANALYSIS
================================================================================
Analysis started at: 2026-01-28 02:49:13

================================================================================
1. FIXTURES ANALYSIS
================================================================================

ğŸ“Š Basic Statistics:
  Total fixtures: 18,044
  Columns: 17
  Memory usage: 7.36 MB

ğŸ“… Temporal Coverage:
  Date range: 2016-01-02 12:45:00 to 2025-12-30 20:15:00
  Years covered: 10

  Fixtures per year:
    2016: 1,812
    2017: 1,878
    2018: 1,808
    2019: 1,823
    2020: 1,671
    2021: 1,988
    2022: 1,690
    2023: 1,920
    2024: 1,718
    2025: 1,736

â“ Missing Values:
            Count  Percentage
home_score    101    0.559743
away_score    101    0.559743
result        101    0.559743
round_id        1    0.005542

ğŸ¯ Result Distribution:
  H: 7,933 (44.2%)
  A: 5,529 (30.8%)
  D: 4,481 (25.0%)
  Missing: 101 (0.6%)

ğŸ† League Coverage:
  Unique leagues: 5
  Top 10 leagues by fixtures:
    League 564: 3,802
    League 384: 3,798
    League 8: 3,796
    League 301: 3,606
    League 82: 3,042

âš½ Team Coverage:
  Unique teams: 163

âœ… Data Integrity:
  Duplicate fixture_ids: 0
  Negative scores: 0
  Result/Score mismatches: 4742

================================================================================
2. STATISTICS ANALYSIS
================================================================================

ğŸ“Š Basic Statistics:
  Total rows: 1,830
  Columns: 33
  Memory usage: 0.45 MB

ğŸ“ˆ Coverage:
  Unique fixtures: 915

  Rows per fixture distribution:
    2 rows: 915 fixtures

ğŸ¯ Critical Statistics Availability:
  âœ… shots_total              :   1,830 /   1,830 (100.0%)
  âš ï¸ shots_on_target          :   1,488 /   1,830 ( 81.3%)
  âœ… shots_inside_box         :   1,830 /   1,830 (100.0%)
  âŒ shots_outside_box        : NOT FOUND
  âœ… possession               :   1,828 /   1,830 ( 99.9%)
  âŒ corners                  : NOT FOUND
  âŒ tackles                  : NOT FOUND
  âœ… interceptions            :   1,784 /   1,830 ( 97.5%)
  âŒ fouls                    : NOT FOUND
  âœ… passes_total             :   1,726 /   1,830 ( 94.3%)
  âœ… passes_accurate          :   1,828 /   1,830 ( 99.9%)
  âš ï¸ attacks                  :   1,096 /   1,830 ( 59.9%)
  âŒ dangerous_attacks        : NOT FOUND

ğŸ”— Join Quality with Fixtures:
  Fixtures with statistics: 915 / 18,044 (5.1%)
  Fixtures without statistics: 17,129
  Statistics without fixtures: 0

================================================================================
3. LINEUPS ANALYSIS
================================================================================

ğŸ“Š Basic Statistics:
  Total rows: 531,717
  Columns: 61
  Memory usage: 899.96 MB

ğŸ“ˆ Coverage:
  Unique fixtures with lineups: 13,419
  Unique players: 9,600

  Players per fixture:
    Mean: 39.6
    Median: 40
    Min: 29
    Max: 52

âš½ Lineup Composition:
  Starters: 295,213 (55.5%)
  Bench: 236,504 (44.5%)

ğŸ¯ Player Statistics Availability:
  âŒ rating              :  33,465 / 531,717 (  6.3%)
  âŒ minutes_played      : NOT FOUND
  âŒ goals               : NOT FOUND
  âŒ assists             : NOT FOUND
  âŒ shots_total         :  86,908 / 531,717 ( 16.3%)
  âŒ passes_total        : 132,345 / 531,717 ( 24.9%)
  âš ï¸ tackles             : 227,010 / 531,717 ( 42.7%)
  âš ï¸ interceptions       : 265,197 / 531,717 ( 49.9%)

ğŸ“Š Rating Distribution:
  Mean: 4.28
  Median: 1.00
  Min: 1.00
  Max: 126.00
  Std: 13.27

ğŸ”— Join Quality with Fixtures:
  Fixtures with lineups: 13,419 / 18,044 (74.4%)
  Fixtures without lineups: 4,625

================================================================================
4. SIDELINED ANALYSIS
================================================================================

ğŸ“Š Basic Statistics:
  Total rows: 100,601
  Columns: 6
  Memory usage: 4.61 MB

ğŸ“ˆ Coverage:
  Unique players sidelined: 4,525
  Unique fixtures: 17,255

ğŸ¥ Sidelined Reasons (Top 15):

ğŸ“… Temporal Coverage:
  Earliest start: NaT
  Latest end: NaT

  Missing start_date: 100,601 (100.0%)
  Missing end_date: 100,601 (100.0%)

================================================================================
5. CROSS-TABLE ANALYSIS
================================================================================

ğŸ”— Data Coverage Across Tables:
  Total fixtures: 18,044
  With statistics: 915 (5.1%)
  With lineups: 13,419 (74.4%)
  With sidelined data: 17,255 (95.6%)

âœ… Fixtures with COMPLETE data (fixtures + stats + lineups):
  887 / 18,044 (4.9%)

================================================================================
6. OVERALL QUALITY SUMMARY
================================================================================

ğŸ“‹ Quality Assessment:
  âœ… Data quality is EXCELLENT!
  âœ… Ready for training dataset generation

ğŸ’¡ Recommendations:
  â€¢ 17,129 fixtures missing statistics - consider re-running data collection
  â€¢ Lineup coverage is 74.4% - feature engine will use team averages as fallback

  â€¢ Proceed to: python scripts/generate_training_data.py

================================================================================
ANALYSIS COMPLETE
================================================================================
